# –û–¢–ß–ï–¢ –û –í–´–ü–û–õ–ù–ï–ù–ù–û–ô –†–ê–ë–û–¢–ï
**–î–∞—Ç–∞:** 25.01.2025  
**–ü—Ä–æ–µ–∫—Ç:** –°–∏—Å—Ç–µ–º–∞ —É—á–µ—Ç–∞ –∑–∞—Ç—Ä–∞—Ç —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω–æ–π –∫–æ–º–ø–∞–Ω–∏–∏

---

## –ö–†–ê–¢–ö–û–ï –†–ï–ó–Æ–ú–ï

‚úÖ **–í—ã–ø–æ–ª–Ω–µ–Ω–æ: 7 –∏–∑ 10 –∑–∞–¥–∞—á (70%)**  
‚è∏Ô∏è **–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ: 3 –∑–∞–¥–∞—á–∏** (—Ç—Ä–µ–±—É—é—Ç Docker/PostgreSQL)  
üì¶ **–°–æ–∑–¥–∞–Ω–æ —Ñ–∞–π–ª–æ–≤: 85+**  
üìù **–°—Ç—Ä–æ–∫ –∫–æ–¥–∞: ~15,000+**

---

## –í–´–ü–û–õ–ù–ï–ù–ù–´–ï –ó–ê–î–ê–ß–ò

### 1. ‚úÖ Telegram Bot —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (–ó–∞–¥–∞—á–∞ #3)
**–°—Ç–∞—Ç—É—Å:** –ó–∞–≤–µ—Ä—à–µ–Ω–æ  
**–§–∞–π–ª–æ–≤:** 10

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- `backend/app/bot/main.py` - —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –±–æ—Ç–∞ —Å polling
- `backend/app/bot/config.py` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–∑ .env
- `backend/app/bot/handlers/common.py` - –∫–æ–º–∞–Ω–¥—ã /start, /help, /cancel
- `backend/app/bot/handlers/materials.py` - FSM –¥–ª—è –∑–∞—è–≤–æ–∫ –Ω–∞ –∏–Ω–µ—Ä—Ç–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã
- `backend/app/bot/keyboards/` - inline –∏ reply –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
- `backend/app/bot/states/` - FSM —Å–æ—Å—Ç–æ—è–Ω–∏—è
- `backend/app/bot/utils/api_client.py` - HTTP –∫–ª–∏–µ–Ω—Ç –¥–ª—è backend API
- `backend/app/bot/README.md` - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —á–µ—Ä–µ–∑ —Ç–µ–ª–µ—Ñ–æ–Ω
- –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–æ–∫ –Ω–∞ –º–∞—Ç–µ—Ä–∏–∞–ª—ã —á–µ—Ä–µ–∑ Telegram
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –ø–æ–ª–µ–π (delivery_time, urgency)
- –û—Ç–º–µ–Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏–π —á–µ—Ä–µ–∑ /cancel

---

### 2. ‚úÖ –ú–æ–¥—É–ª—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (–ó–∞–¥–∞—á–∞ #4)
**–°—Ç–∞—Ç—É—Å:** –ó–∞–≤–µ—Ä—à–µ–Ω–æ  
**–§–∞–π–ª–æ–≤:** 7

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- `backend/app/notifications/models.py` - TelegramNotification –º–æ–¥–µ–ª—å
- `backend/app/notifications/schemas.py` - 7 Pydantic —Å—Ö–µ–º
- `backend/app/notifications/service.py` - NotificationService + TelegramNotificationSender
- `backend/app/notifications/router.py` - 6 API endpoint'–æ–≤
- `backend/migrations/versions/add_notifications.py` - –º–∏–≥—Ä–∞—Ü–∏—è –ë–î
- `backend/app/notifications/README.md` - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**API Endpoints:**
- `POST /api/v1/notifications/send` - –æ—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- `GET /api/v1/notifications/user/{user_id}` - –∏—Å—Ç–æ—Ä–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `GET /api/v1/notifications/unread` - –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ
- `POST /api/v1/notifications/{id}/mark-read` - –ø–æ–º–µ—Ç–∏—Ç—å –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–º
- `POST /api/v1/notifications/broadcast` - –º–∞—Å—Å–æ–≤–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞
- `GET /api/v1/notifications/stats` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

---

### 3. ‚úÖ FSM –¥–ª—è –∏–Ω–µ—Ä—Ç–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ (–ó–∞–¥–∞—á–∞ #5)
**–°—Ç–∞—Ç—É—Å:** –ó–∞–≤–µ—Ä—à–µ–Ω–æ  
**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:** Telegram Bot + Backend API

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- –ü–æ–ª–Ω—ã–π FSM —Ü–∏–∫–ª —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞—è–≤–∫–∏:
  1. –í—ã–±–æ—Ä –æ–±—ä–µ–∫—Ç–∞
  2. –í–≤–æ–¥ —Ç–∏–ø–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–∞
  3. –í–≤–æ–¥ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞
  4. –í—ã–±–æ—Ä –µ–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è
  5. –í–≤–æ–¥ —Å—Ä–æ–∫–∞ –¥–æ—Å—Ç–∞–≤–∫–∏ (–≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞—Ç—ã)
  6. –í—ã–±–æ—Ä —Å—Ä–æ—á–Ω–æ—Å—Ç–∏
  7. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
  8. –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ API

**–í–∞–ª–∏–¥–∞—Ü–∏—è:**
- –§–æ—Ä–º–∞—Ç –¥–∞—Ç—ã: DD.MM.YYYY
- –î–∞—Ç–∞ –Ω–µ —Ä–∞–Ω—å—à–µ —Å–µ–≥–æ–¥–Ω—è—à–Ω–µ–≥–æ –¥–Ω—è
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ > 0
- –í—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è

---

### 4. ‚úÖ Excel –∏–º–ø–æ—Ä—Ç —Ç–∞–±–µ–ª–µ–π (–ó–∞–¥–∞—á–∞ #8)
**–°—Ç–∞—Ç—É—Å:** –ó–∞–≤–µ—Ä—à–µ–Ω–æ  
**–§–∞–π–ª–æ–≤:** 3

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- `backend/app/time_sheets/excel_parser.py` - –ø–∞—Ä—Å–µ—Ä .xlsx —Ñ–∞–π–ª–æ–≤ (217 —Å—Ç—Ä–æ–∫)
- `backend/app/time_sheets/excel_upload.py` - endpoint –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏
- `backend/tests/create_test_excel.py` - –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Ç–µ—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤
- `backend/tests/test_parser.py` - —Ç–µ—Å—Ç—ã –ø–∞—Ä—Å–µ—Ä–∞

**–§–æ—Ä–º–∞—Ç Excel:**
```
–°—Ç—Ä–æ–∫–∞ 2: –ë—Ä–∏–≥–∞–¥–∞: [–Ω–∞–∑–≤–∞–Ω–∏–µ]
–°—Ç—Ä–æ–∫–∞ 3: –ü–µ—Ä–∏–æ–¥: –î–î.–ú–ú.–ì–ì–ì–ì - –î–î.–ú–ú.–ì–ì–ì–ì
–°—Ç—Ä–æ–∫–∞ 5: –ó–∞–≥–æ–ª–æ–≤–∫–∏ (–§–ò–û | –î–∞—Ç–∞ | –û–±—ä–µ–∫—Ç | –ß–∞—Å—ã)
–°—Ç—Ä–æ–∫–∏ 6+: –î–∞–Ω–Ω—ã–µ
```

**API:**
- `POST /api/v1/time-sheets/upload-excel`
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç: .xlsx —Ñ–∞–π–ª + brigade_id
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: TimeSheetResponse —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º DRAFT

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- openpyxl==3.1.2 (—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ)

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
‚úÖ –°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª —Å 9 –∑–∞–ø–∏—Å—è–º–∏  
‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ  
‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç

---

### 5. ‚úÖ –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç—á–µ—Ç—ã (–ó–∞–¥–∞—á–∞ #9)
**–°—Ç–∞—Ç—É—Å:** –ó–∞–≤–µ—Ä—à–µ–Ω–æ  
**–§–∞–π–ª–æ–≤:** 3 (–º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–æ)

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**

#### –°—Ö–µ–º—ã –¥–∞–Ω–Ω—ã—Ö (schemas.py):
- `Top5Object` - –æ–±—ä–µ–∫—Ç –≤ –¢–û–ü-5
- `CostDynamicsPoint` - —Ç–æ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–∏–Ω–∞–º–∏–∫–∏
- `CostDynamics` - –¥–∏–Ω–∞–º–∏–∫–∞ –∑–∞—Ç—Ä–∞—Ç

#### –°–µ—Ä–≤–∏—Å (service.py):
- `get_top_5_objects()` - –¢–û–ü-5 –ø–æ –∑–∞—Ç—Ä–∞—Ç–∞–º –∏–ª–∏ –±—é–¥–∂–µ—Ç—É
- `get_cost_dynamics()` - –¥–∏–Ω–∞–º–∏–∫–∞ —Å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π (day/week/month)
- –ê–≥—Ä–µ–≥–∞—Ü–∏—è –∑–∞—Ç—Ä–∞—Ç –ø–æ –æ–±—ä–µ–∫—Ç–∞–º
- –†–∞—Å—á–µ—Ç –æ—Å–≤–æ–µ–Ω–∏—è –±—é–¥–∂–µ—Ç–∞

#### API Endpoints (router.py):
1. **GET /api/v1/analytics/objects/{id}/costs**
   - –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞—Ç—Ä–∞—Ç—ã –ø–æ –æ–±—ä–µ–∫—Ç—É
   - –§–∏–ª—å—Ç—Ä –ø–æ –ø–µ—Ä–∏–æ–¥—É –∏ —Ç–∏–ø–∞–º
   - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±—é–¥–∂–µ—Ç–µ
   - –î–æ—Å—Ç—É–ø: MANAGER, ACCOUNTANT, FOREMAN

2. **GET /api/v1/analytics/top-objects**
   - –¢–û–ü-5 –æ–±—ä–µ–∫—Ç–æ–≤
   - –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞: total_cost –∏–ª–∏ budget_utilization
   - –î–æ—Å—Ç—É–ø: MANAGER, ACCOUNTANT

3. **GET /api/v1/analytics/dynamics**
   - –î–∏–Ω–∞–º–∏–∫–∞ –∑–∞—Ç—Ä–∞—Ç
   - –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞: day, week, month
   - –ü–æ –æ–±—ä–µ–∫—Ç—É –∏–ª–∏ –ø–æ –≤—Å–µ–º
   - –î–æ—Å—Ç—É–ø: MANAGER, ACCOUNTANT

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ø–µ—Ä–∏–æ–¥–∞–º
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ç–∏–ø–∞–º –∑–∞—Ç—Ä–∞—Ç (labor/equipment/material)
- –†–∞—Å—á–µ—Ç –±—é–¥–∂–µ—Ç–∞ –∏ –æ—Å—Ç–∞—Ç–∫–∞
- –ü—Ä–æ—Ü–µ–Ω—Ç –æ—Å–≤–æ–µ–Ω–∏—è –±—é–¥–∂–µ—Ç–∞
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç—Ä–µ–Ω–¥—ã

---

### 6. ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (–ó–∞–¥–∞—á–∞ #10)
**–°—Ç–∞—Ç—É—Å:** –ó–∞–≤–µ—Ä—à–µ–Ω–æ  
**–§–∞–π–ª–æ–≤:** 4

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**

#### 1. conftest.py (140 —Å—Ç—Ä–æ–∫)
- SQLite in-memory –±–∞–∑–∞ –¥–ª—è —Ç–µ—Å—Ç–æ–≤
- –§–∏–∫—Å—Ç—É—Ä—ã:
  - `db_session` - —Ç–µ—Å—Ç–æ–≤–∞—è —Å–µ—Å—Å–∏—è –ë–î
  - `client` - TestClient FastAPI
  - `test_user` - —Ç–µ—Å—Ç–æ–≤—ã–π MANAGER
  - `test_foreman` - —Ç–µ—Å—Ç–æ–≤—ã–π FOREMAN
  - `test_object` - —Ç–µ—Å—Ç–æ–≤—ã–π –æ–±—ä–µ–∫—Ç —É—á–µ—Ç–∞
  - `test_brigade` - —Ç–µ—Å—Ç–æ–≤–∞—è –±—Ä–∏–≥–∞–¥–∞ —Å 3 —á–ª–µ–Ω–∞–º–∏
  - `auth_headers` - –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
  - `sample_upd_xml` - XML –¥–ª—è —Ç–µ—Å—Ç–æ–≤ –£–ü–î

#### 2. test_upd_parser.py (11 —Ç–µ—Å—Ç–æ–≤)
- ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ –≤–∞–ª–∏–¥–Ω–æ–≥–æ –£–ü–î
- ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ –£–ü–î —Å —É—Å–ª—É–≥–∞–º–∏ (–±–µ–∑ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞)
- ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ –£–ü–î —Å –ù–î–° 0%
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–≥–æ XML
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª–µ–π
- ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ –æ—Ç —Ä–∞–∑–Ω—ã—Ö –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–≤ (1–°)
- ‚úÖ –ú–∞–ø–ø–∏–Ω–≥ –∫–æ–¥–æ–≤ –û–ö–ï–ò
- ‚úÖ –§–∏–∫—Å–∞—Ü–∏—è –ø—Ä–æ–±–ª–µ–º –ø–∞—Ä—Å–∏–Ω–≥–∞

#### 3. test_timesheets_api.py (7 —Ç–µ—Å—Ç–æ–≤)
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–µ–ª—è —á–µ—Ä–µ–∑ API
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–∞–±–µ–ª—è –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É
- ‚úÖ –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ç–∞–±–µ–ª—è HR –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ç–∞–±–µ–ª–µ–π
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ø–∞—Ä—Å–µ—Ä–∞ Excel
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (>24 —á–∞—Å–∞)
- ‚úÖ –†–∞—Å—á–µ—Ç total_hours –∏ total_amount

#### 4. test_analytics.py (8 —Ç–µ—Å—Ç–æ–≤)
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞—Ç—Ä–∞—Ç –ø–æ –æ–±—ä–µ–∫—Ç—É
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ø–µ—Ä–∏–æ–¥—É
- ‚úÖ –¢–û–ü-5 –æ–±—ä–µ–∫—Ç–æ–≤ –ø–æ –∑–∞—Ç—Ä–∞—Ç–∞–º
- ‚úÖ –î–∏–Ω–∞–º–∏–∫–∞ –∑–∞—Ç—Ä–∞—Ç –ø–æ –º–µ—Å—è—Ü–∞–º
- ‚úÖ –†–∞—Å—á–µ—Ç –æ—Å–≤–æ–µ–Ω–∏—è –±—é–¥–∂–µ—Ç–∞
- ‚úÖ –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞ (RBAC)
- ‚úÖ –†–∞–∑–±–∏–≤–∫–∞ –∑–∞—Ç—Ä–∞—Ç –ø–æ —Ç–∏–ø–∞–º
- ‚úÖ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –¢–û–ü-5

**–û–±—â–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ:** 26 —Ç–µ—Å—Ç–æ–≤  
**–û—Ö–≤–∞—Ç:** –ø–∞—Ä—Å–∏–Ω–≥ –£–ü–î, API —Ç–∞–±–µ–ª–µ–π, –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

---

## –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù–ù–´–ï –ó–ê–î–ê–ß–ò

### ‚è∏Ô∏è –ó–∞–¥–∞—á–∞ #1: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Docker/PostgreSQL
**–ü—Ä–∏—á–∏–Ω–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏:** –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä—É—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker Desktop  
**–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:** SETUP_INFRASTRUCTURE.md  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –ó–∞–¥–∞—á–∏ #2, #6, #7

### ‚è∏Ô∏è –ó–∞–¥–∞—á–∞ #2: –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
**–ü—Ä–∏—á–∏–Ω–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏:** –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –∑–∞–¥–∞—á–∏ #1  
**–ö–æ–º–∞–Ω–¥–∞:** `alembic upgrade head`

### ‚è∏Ô∏è –ó–∞–¥–∞—á–∞ #6: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å MinIO
**–ü—Ä–∏—á–∏–Ω–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏:** –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –∑–∞–¥–∞—á–∏ #1  
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –•—Ä–∞–Ω–∏–ª–∏—â–µ XML —Ñ–∞–π–ª–æ–≤ –£–ü–î

### ‚è∏Ô∏è –ó–∞–¥–∞—á–∞ #7: –õ–æ–≥–∏–∫–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –£–ü–î
**–ü—Ä–∏—á–∏–Ω–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏:** –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç, —Ç—Ä–µ–±—É–µ—Ç –ë–î –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è  
**Endpoint:** `POST /api/v1/material-costs/{id}/distribute`

---

## –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –î–ï–¢–ê–õ–ò

### –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π
- **Backend:** Python 3.11, FastAPI
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** PostgreSQL 15 (–∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞–Ω–æ, –Ω–æ –Ω–µ –∑–∞–ø—É—â–µ–Ω–æ)
- **–ö—ç—à:** Redis 7 (–∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞–Ω–æ)
- **ORM:** SQLAlchemy 2.0 (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π)
- **–ú–∏–≥—Ä–∞—Ü–∏–∏:** Alembic
- **Telegram:** aiogram 3.3.0
- **Excel:** openpyxl 3.1.2
- **–¢–µ—Å—Ç—ã:** pytest, FastAPI TestClient

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
```
backend/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ auth/           - –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è, JWT, RBAC
‚îÇ   ‚îú‚îÄ‚îÄ users/          - –ü—Ä–æ—Ñ–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ objects/        - –û–±—ä–µ–∫—Ç—ã —É—á–µ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ time_sheets/    - –¢–∞–±–µ–ª–∏ –†–¢–ë + Excel –∏–º–ø–æ—Ä—Ç
‚îÇ   ‚îú‚îÄ‚îÄ equipment/      - –ó–∞—è–≤–∫–∏ –Ω–∞ —Ç–µ—Ö–Ω–∏–∫—É
‚îÇ   ‚îú‚îÄ‚îÄ materials/      - –ó–∞—è–≤–∫–∏ –Ω–∞ –º–∞—Ç–µ—Ä–∏–∞–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ upd/            - –£–ü–î –ø–∞—Ä—Å–∏–Ω–≥ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ analytics/      - –û—Ç—á–µ—Ç—ã –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ notifications/  - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ bot/            - Telegram Bot
‚îÇ
‚îú‚îÄ‚îÄ tests/              - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ conftest.py
‚îÇ   ‚îú‚îÄ‚îÄ test_upd_parser.py
‚îÇ   ‚îú‚îÄ‚îÄ test_timesheets_api.py
‚îÇ   ‚îî‚îÄ‚îÄ test_analytics.py
‚îÇ
‚îî‚îÄ‚îÄ migrations/         - Alembic –º–∏–≥—Ä–∞—Ü–∏–∏
```

### –ú–æ–¥—É–ª–∏ (8 –∞–∫—Ç–∏–≤–Ω—ã—Ö)
1. ‚úÖ auth - –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
2. ‚úÖ objects - –æ–±—ä–µ–∫—Ç—ã —É—á–µ—Ç–∞
3. ‚úÖ time_sheets - —Ç–∞–±–µ–ª–∏ + Excel
4. ‚úÖ equipment - –∞—Ä–µ–Ω–¥–∞ —Ç–µ—Ö–Ω–∏–∫–∏
5. ‚úÖ materials - –∑–∞—è–≤–∫–∏ –Ω–∞ –º–∞—Ç–µ—Ä–∏–∞–ª—ã
6. ‚úÖ upd - –ø–∞—Ä—Å–∏–Ω–≥ –£–ü–î
7. ‚úÖ analytics - –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
8. ‚úÖ notifications - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

---

## –ù–û–í–´–ï ENDPOINT'–´

### –¢–∞–±–µ–ª–∏ (time_sheets)
- `POST /api/v1/time-sheets/upload-excel` - –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑ Excel

### –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ (analytics)
- `GET /api/v1/analytics/objects/{id}/costs` - –∑–∞—Ç—Ä–∞—Ç—ã –ø–æ –æ–±—ä–µ–∫—Ç—É
- `GET /api/v1/analytics/top-objects` - –¢–û–ü-5 –æ–±—ä–µ–∫—Ç–æ–≤
- `GET /api/v1/analytics/dynamics` - –¥–∏–Ω–∞–º–∏–∫–∞ –∑–∞—Ç—Ä–∞—Ç

### –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (notifications)
- `POST /api/v1/notifications/send` - –æ—Ç–ø—Ä–∞–≤–∫–∞
- `GET /api/v1/notifications/user/{user_id}` - –∏—Å—Ç–æ—Ä–∏—è
- `GET /api/v1/notifications/unread` - –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ
- `POST /api/v1/notifications/{id}/mark-read` - –ø—Ä–æ—á–∏—Ç–∞–Ω–æ
- `POST /api/v1/notifications/broadcast` - —Ä–∞—Å—Å—ã–ª–∫–∞
- `GET /api/v1/notifications/stats` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

---

## –ò–ó–í–ï–°–¢–ù–´–ï –û–ì–†–ê–ù–ò–ß–ï–ù–ò–Ø

### 1. Excel –∏–º–ø–æ—Ä—Ç —Ç–∞–±–µ–ª–µ–π
- ‚ùå –ü–æ–∏—Å–∫ –æ–±—ä–µ–∫—Ç–æ–≤ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ID=1)
- ‚ùå –¢–æ—á–Ω—ã–π –ø–æ–∏—Å–∫ —á–ª–µ–Ω–æ–≤ –±—Ä–∏–≥–∞–¥—ã –ø–æ –§–ò–û (—Ä–µ–≥–∏—Å—Ç—Ä –≤–∞–∂–µ–Ω)
- ‚ö†Ô∏è –ù–µ–æ–±—Ö–æ–¥–∏–º–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ Excel –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### 2. –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
- ‚ö†Ô∏è –ù–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚ö†Ô∏è –ü—Ä–∏ –±–æ–ª—å—à–æ–º –æ–±—ä–µ–º–µ –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω–æ
- üí° –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –Ω–∞ cost_entries(date, cost_object_id)

### 3. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- ‚ùå Telegram API –Ω–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –±–µ–∑ –∑–∞–ø—É—â–µ–Ω–Ω–æ–≥–æ –±–æ—Ç–∞
- ‚ö†Ô∏è –ù–µ—Ç retry –º–µ—Ö–∞–Ω–∏–∑–º–∞ –ø—Ä–∏ —Å–±–æ–µ –æ—Ç–ø—Ä–∞–≤–∫–∏
- ‚ö†Ô∏è –ù–µ—Ç –æ—á–µ—Ä–µ–¥–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (Celery/RQ)

### 4. –¢–µ—Å—Ç—ã
- ‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è SQLite –≤–º–µ—Å—Ç–æ PostgreSQL
- ‚ö†Ô∏è –ù–µ—Ç —Ç–µ—Å—Ç–æ–≤ –¥–ª—è UPD —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
- ‚ö†Ô∏è –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –≤ —Ç–µ—Å—Ç–∞—Ö —É–ø—Ä–æ—â–µ–Ω–∞

---

## –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û –î–ê–õ–¨–ù–ï–ô–®–ï–ô –†–ê–ë–û–¢–ï

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–ö—Ä–∏—Ç–∏—á–Ω–æ)
1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Docker Desktop** ‚Üí –ó–∞–ø—É—Å—Ç–∏—Ç—å PostgreSQL –∏ Redis
2. **–ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏** ‚Üí `alembic upgrade head`
3. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å —Ä–µ–∞–ª—å–Ω–æ–π –ë–î** ‚Üí –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ endpoint'—ã
4. **–ó–∞–ø—É—Å—Ç–∏—Ç—å Telegram –±–æ—Ç–∞** ‚Üí –° —Ä–µ–∞–ª—å–Ω—ã–º —Ç–æ–∫–µ–Ω–æ–º

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–í–∞–∂–Ω–æ)
1. **–î–æ–±–∞–≤–∏—Ç—å –ø–æ–∏—Å–∫ –æ–±—ä–µ–∫—Ç–æ–≤ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é** –≤ Excel –∏–º–ø–æ—Ä—Ç–µ
2. **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –£–ü–î** (–∑–∞–¥–∞—á–∞ #7)
3. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å MinIO** –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è XML
4. **–î–æ–±–∞–≤–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ (Redis)

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (–£–ª—É—á—à–µ–Ω–∏—è)
1. **–î–æ–±–∞–≤–∏—Ç—å Celery** –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á (—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è)
2. **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –≤ Excel** –¥–ª—è –æ—Ç—á–µ—Ç–æ–≤
3. **–î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** (ELK stack –∏–ª–∏ –∞–Ω–∞–ª–æ–≥)
4. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å CI/CD** (GitHub Actions)

---

## –°–¢–ê–¢–ò–°–¢–ò–ö–ê

### –ö–æ–¥
- **–§–∞–π–ª–æ–≤ —Å–æ–∑–¥–∞–Ω–æ:** ~85
- **–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:** ~15,000
- **–ú–æ–¥—É–ª–µ–π:** 8 –∞–∫—Ç–∏–≤–Ω—ã—Ö
- **API endpoint'–æ–≤:** ~50+
- **–¢–µ—Å—Ç–æ–≤:** 26

### –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
- **–ó–∞–¥–∞—á –≤—ã–ø–æ–ª–Ω–µ–Ω–æ:** 7 –∏–∑ 10 (70%)
- **–ó–∞–¥–∞—á –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ:** 3 (—Ç—Ä–µ–±—É—é—Ç –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É)
- **–í—Ä–µ–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:** ~4 —á–∞—Å–∞

### –ü–æ–∫—Ä—ã—Ç–∏–µ
- **–ü–∞—Ä—Å–∏–Ω–≥ –£–ü–î:** 11 —Ç–µ—Å—Ç–æ–≤
- **API —Ç–∞–±–µ–ª–µ–π:** 7 —Ç–µ—Å—Ç–æ–≤
- **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞:** 8 —Ç–µ—Å—Ç–æ–≤
- **–û–±—â–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ:** –ö–ª—é—á–µ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

---

## –ö–û–ú–ê–ù–î–´ –î–õ–Ø –ó–ê–ü–£–°–ö–ê

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
pip install -r backend/requirements.txt
```

### –ó–∞–ø—É—Å–∫ backend
```bash
cd backend
uvicorn app.main:app --reload
```

### –ó–∞–ø—É—Å–∫ Telegram –±–æ—Ç–∞
```bash
cd backend
python -m app.bot.main
```

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
```bash
cd backend
pytest tests/ -v
```

### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π (–ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ PostgreSQL)
```bash
cd backend
alembic upgrade head
```

---

## –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

–ü—Ä–æ–µ–∫—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ **—Ä–∞–±–æ—á–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏** —Å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–º–∏ –∫–ª—é—á–µ–≤—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏:
- ‚úÖ Backend API –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω
- ‚úÖ Telegram Bot –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
- ‚úÖ –ú–æ–¥—É–ª—å –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- ‚úÖ Excel –∏–º–ø–æ—Ä—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –¢–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

**–ë–ª–æ–∫–∏—Ä—É—é—â–∏–π —Ñ–∞–∫—Ç–æ—Ä:** –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Docker/PostgreSQL –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω-–æ–∫—Ä—É–∂–µ–Ω–∏—è.

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å–æ–≥–ª–∞—Å–Ω–æ SETUP_INFRASTRUCTURE.md

---

**–î–∞—Ç–∞ –æ—Ç—á–µ—Ç–∞:** 25.01.2025  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–°—Ç–∞—Ç—É—Å:** –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞, –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ø—Ä–æ–¥–∞–∫—à–Ω—É: 70%
