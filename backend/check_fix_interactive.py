#!/usr/bin/env python3
"""
–ß–ï–ö–õ–ò–°–¢ –ü–†–û–í–ï–†–ö–ò: –∫–æ–º–∞–Ω–¥–∞ /request-access

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø—É–Ω–∫—Ç—ã –¥–ª—è –ø–æ–ª–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
"""

# ================================================================
# –ß–ï–ö–õ–ò–°–¢ –î–ò–ê–ì–ù–û–°–¢–ò–ö–ò –ò –ü–†–û–í–ï–†–ö–ò
# ================================================================

checks = [
    ("‚úÖ –ü–û–î–ì–û–¢–û–í–ö–ê", [
        ("1.1", "–°–µ—Ä–≤–µ—Ä FastAPI –∑–∞–ø—É—â–µ–Ω", "curl http://localhost:8000/docs", "‚úÖ –î–æ–ª–∂–Ω–∞ –æ—Ç–∫—Ä—ã—Ç—å—Å—è Swagger UI"),
        ("1.2", "–ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ", "python -m app.bot.main", "‚úÖ –ë–µ–∑ –æ—à–∏–±–æ–∫"),
        ("1.3", "–û–±—ä–µ–∫—Ç—ã –µ—Å—Ç—å –≤ –ë–î", "python diagnose_objects.py", "‚úÖ –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å –æ–±—ä–µ–∫—Ç—ã"),
    ]),
    
    ("‚úÖ –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê", [
        ("2.1", "–ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É", "python diagnose_objects.py", """
‚úÖ cost_objects: 1 –∑–∞–ø–∏—Å–µ–π
‚úÖ GET /objects/ —Å—Ç–∞—Ç—É—Å: 200
‚úÖ –û–±—ä–µ–∫—Ç—ã –≤ –æ—Ç–≤–µ—Ç–µ: 1
        """),
        ("2.2", "–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è", "python test_request_access_fix.py", """
‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞
‚úÖ –ü–æ–ª—É—á–µ–Ω–æ –æ–±—ä–µ–∫—Ç–æ–≤: 1
‚úÖ –û–±—ä–µ–∫—Ç: OBJ-2026-001
        """),
        ("2.3", "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å", "python -m py_compile app/bot/handlers/objects.py", "‚úÖ –ë–µ–∑ –æ—à–∏–±–æ–∫"),
    ]),
    
    ("‚úÖ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ë–û–¢–ê", [
        ("3.1", "–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ –±–æ—Ç–µ", "–û—Ç–ø—Ä–∞–≤–∏—Ç—å /start", """
‚úÖ –ë–æ—Ç –æ—Ç–≤–µ—Ç–∏—Ç: "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å"
‚úÖ –ü–æ–∫–∞–∂–µ—Ç –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
        """),
        ("3.2", "–ó–∞–ø—Ä–æ—Å –¥–æ—Å—Ç—É–ø–∞", "–û—Ç–ø—Ä–∞–≤–∏—Ç—å /request-access", """
‚úÖ –ë–æ—Ç –ø–æ–∫–∞–∂–µ—Ç —Å–ø–∏—Å–æ–∫ –æ–±—ä–µ–∫—Ç–æ–≤
‚úÖ –û–±—ä–µ–∫—Ç: OBJ-2026-001 - —ã—Ä–∞–ø—ã–≤–∞—Ä
‚úÖ –ö–Ω–æ–ø–∫–∏ –¥–ª—è –≤—ã–±–æ—Ä–∞
        """),
        ("3.3", "–í—ã–±–æ—Ä –æ–±—ä–µ–∫—Ç–∞", "–ù–∞–∂–∞—Ç—å –Ω–∞ –æ–±—ä–µ–∫—Ç", """
‚úÖ –ë–æ—Ç —Å–ø—Ä–æ—Å–∏—Ç –æ –ø—Ä–∏—á–∏–Ω–µ
‚úÖ –ü–æ—è–≤—è—Ç—Å—è –∫–Ω–æ–ø–∫–∏ \"–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å\" –∏ \"–û—Ç–º–µ–Ω–∞\"
        """),
        ("3.4", "–û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞", "–í–≤–µ—Å—Ç–∏ –ø—Ä–∏—á–∏–Ω—É –∏–ª–∏ –Ω–∞–∂–∞—Ç—å –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å", """
‚úÖ –ë–æ—Ç —Å–∫–∞–∂–µ—Ç: \"–ó–∞–ø—Ä–æ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!\"
‚úÖ –ü–æ–∫–∞–∂–µ—Ç –¥–µ—Ç–∞–ª–∏ –∑–∞–ø—Ä–æ—Å–∞
        """),
        ("3.5", "–ü—Ä–æ—Å–º–æ—Ç—Ä —Å–≤–æ–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤", "–û—Ç–ø—Ä–∞–≤–∏—Ç—å /my-requests", """
‚úÖ –ë–æ—Ç –ø–æ–∫–∞–∂–µ—Ç —Å–ø–∏—Å–æ–∫ –∑–∞–ø—Ä–æ—Å–æ–≤
‚úÖ –°—Ç–∞—Ç—É—Å: ‚è≥ –ù–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏
        """),
    ]),
    
    ("‚úÖ –ü–†–û–í–ï–†–ö–ê –û–®–ò–ë–û–ö", [
        ("4.1", "–ë–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏", "–ò–∑–º–µ–Ω–∏—Ç—å API_BASE_URL –Ω–∞ –Ω–µ–≤–µ—Ä–Ω—ã–π", """
‚úÖ –ë–æ—Ç —Å–∫–∞–∂–µ—Ç –æ –æ—à–∏–±–∫–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
‚úÖ –ù–µ —É–ø–∞–¥–µ—Ç (–æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π)
        """),
        ("4.2", "–ù–µ–≤–∞–ª–∏–¥–Ω—ã–π —Ç–æ–∫–µ–Ω", "test_request_access_fix.py", """
‚úÖ –°—Ç–∞—Ç—É—Å 401 Unauthorized (–æ–∂–∏–¥–∞–µ–º–æ)
‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç
        """),
        ("4.3", "–ü—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç –æ—Ç API", "–ï—Å–ª–∏ —É–¥–∞–ª–∏—Ç—å –æ–±—ä–µ–∫—Ç –∏–∑ –ë–î", """
‚úÖ –ë–æ—Ç —Å–∫–∞–∂–µ—Ç: \"–í —Å–∏—Å—Ç–µ–º–µ –Ω–µ—Ç –æ–±—ä–µ–∫—Ç–æ–≤\"
‚úÖ –ü–æ–∫–∞–∂–µ—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é
        """),
    ]),
]

# ================================================================
# –í–´–í–û–î –ß–ï–ö–õ–ò–°–¢–ê
# ================================================================

def print_checklist():
    """–í—ã–≤–µ—Å—Ç–∏ —á–µ–∫–ª–∏—Å—Ç –≤ –∫–æ–Ω—Å–æ–ª—å"""
    print("\n" + "="*70)
    print("–ß–ï–ö–õ–ò–°–¢ –ü–†–û–í–ï–†–ö–ò: –ö–û–ú–ê–ù–î–ê /request-access")
    print("="*70 + "\n")
    
    for category, items in checks:
        print(f"\n{category}")
        print("-" * 70)
        
        for code, title, command, expected in items:
            print(f"\n  [{code}] {title}")
            print(f"      –ö–æ–º–∞–Ω–¥–∞: {command}")
            print(f"      –û–∂–∏–¥–∞–µ–º–æ: {expected.strip()}")
    
    print("\n" + "="*70)
    print("–ò–¢–û–ì–û: 13 –ø—É–Ω–∫—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä–∫–∏")
    print("="*70)
    print("\n‚úÖ –ï—Å–ª–∏ –≤—Å–µ –ø—É–Ω–∫—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã - —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!")
    print("‚ùå –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç - —Å–º. QUICK_FIX_CHEATSHEET.md\n")

if __name__ == "__main__":
    print_checklist()
    
    # –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º
    print("\n" + "="*70)
    print("–ò–ù–¢–ï–†–ê–ö–¢–ò–í–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê")
    print("="*70)
    
    passed = 0
    failed = 0
    
    # –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞
    print("\n[‚úì] –ü–û–î–ì–û–¢–û–í–ö–ê")
    print("  [1/3] –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω? (y/n): ", end="")
    if input().lower() == 'y':
        passed += 1
    else:
        failed += 1
    
    print("  [2/3] –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω? (y/n): ", end="")
    if input().lower() == 'y':
        passed += 1
    else:
        failed += 1
    
    print("  [3/3] –û–±—ä–µ–∫—Ç—ã –≤ –ë–î? (y/n): ", end="")
    if input().lower() == 'y':
        passed += 1
    else:
        failed += 1
    
    # –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
    print("\n[‚úì] –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê")
    print("  [1/3] diagnose_objects.py –ø–æ–∫–∞–∑–∞–ª –æ–±—ä–µ–∫—Ç—ã? (y/n): ", end="")
    if input().lower() == 'y':
        passed += 1
    else:
        failed += 1
    
    print("  [2/3] test_request_access_fix.py —É—Å–ø–µ—à–µ–Ω? (y/n): ", end="")
    if input().lower() == 'y':
        passed += 1
    else:
        failed += 1
    
    print("  [3/3] –°–∏–Ω—Ç–∞–∫—Å–∏—Å Python OK? (y/n): ", end="")
    if input().lower() == 'y':
        passed += 1
    else:
        failed += 1
    
    # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–æ—Ç–∞
    print("\n[‚úì] –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ë–û–¢–ê")
    print("  [1/5] /start —Ä–∞–±–æ—Ç–∞–µ—Ç? (y/n): ", end="")
    if input().lower() == 'y':
        passed += 1
    else:
        failed += 1
    
    print("  [2/5] /request-access –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ–±—ä–µ–∫—Ç—ã? (y/n): ", end="")
    if input().lower() == 'y':
        passed += 1
    else:
        failed += 1
    
    print("  [3/5] –í—ã–±–æ—Ä –æ–±—ä–µ–∫—Ç–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç? (y/n): ", end="")
    if input().lower() == 'y':
        passed += 1
    else:
        failed += 1
    
    print("  [4/5] –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç? (y/n): ", end="")
    if input().lower() == 'y':
        passed += 1
    else:
        failed += 1
    
    print("  [5/5] /my-requests —Ä–∞–±–æ—Ç–∞–µ—Ç? (y/n): ", end="")
    if input().lower() == 'y':
        passed += 1
    else:
        failed += 1
    
    # –ò—Ç–æ–≥–∏
    total = passed + failed
    percentage = (passed / total * 100) if total > 0 else 0
    
    print("\n" + "="*70)
    print("–†–ï–ó–£–õ–¨–¢–ê–¢–´")
    print("="*70)
    print(f"‚úÖ –ü—Ä–æ–π–¥–µ–Ω–æ: {passed}/{total} ({percentage:.0f}%)")
    print(f"‚ùå –ù–µ –ø—Ä–æ–π–¥–µ–Ω–æ: {failed}/{total}")
    print("="*70 + "\n")
    
    if percentage == 100:
        print("üéâ –ò–î–ï–ê–õ–¨–ù–û! –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã!")
        print("–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ production.")
    elif percentage >= 80:
        print("‚úÖ –•–æ—Ä–æ—à–æ! –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ–π–¥–µ–Ω–æ.")
        print("–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –ø—É–Ω–∫—Ç—ã.")
    elif percentage >= 50:
        print("‚ö†Ô∏è  –ü–æ–ª–æ–≤–∏–Ω–∞ —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ–π–¥–µ–Ω–∞.")
        print("–¢—Ä–µ–±—É—é—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏.")
    else:
        print("‚ùå –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Ç–µ—Å—Ç–æ–≤ –Ω–µ –ø—Ä–æ–π–¥–µ–Ω–æ.")
        print("–ó–∞–ø—É—Å—Ç–∏—Ç–µ: python diagnose_objects.py")
